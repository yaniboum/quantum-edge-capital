<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paramètres - Quantum Edge Capital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@500;700;800&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0a192f; color: #cbd5e1; }
        h1, h2, h3 { font-family: 'Exo 2', sans-serif; font-weight: 700; }
        .card { background-color: #112240; border: 1px solid #1e293b; }
        .tab-btn.active { color: #64ffda; border-color: #64ffda; }
        .alert-success { background-color: #10B981; color: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
        .alert-error { background-color: #EF4444; color: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
    </style>
</head>
<body class="antialiased">
    <div class="flex h-screen bg-[#0a192f]">
        <aside class="w-64 flex-shrink-0 bg-[#112240] p-6 flex-col justify-between hidden md:flex">
            <div>
                <div class="flex items-center space-x-3 mb-10"><canvas id="logo-canvas" width="36" height="36"></canvas><span class="text-xl font-semibold text-white">Quantum Edge</span></div>
                <nav class="space-y-2">
                    <a href="/dashboard" class="flex items-center px-4 py-2 text-lg text-slate-400 hover:bg-[#0a192f] hover:text-white rounded-lg transition-colors"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>Tableau de Bord</a>
                    <a href="/reports" class="flex items-center px-4 py-2 text-lg text-slate-400 hover:bg-[#0a192f] hover:text-white rounded-lg transition-colors"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>Rapports</a>
                    <a href="/settings" class="flex items-center px-4 py-2 text-lg font-semibold bg-[#0a192f] text-[#64ffda] rounded-lg"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>Paramètres</a>
                </nav>
            </div>
            <div><a href="/logout" class="flex items-center px-4 py-2 text-lg text-slate-400 hover:bg-[#0a192f] hover:text-white rounded-lg transition-colors"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>Déconnexion</a></div>
        </aside>
        <main class="flex-1 p-6 lg:p-10 overflow-y-auto">
            <header class="mb-6"><h1 class="text-4xl text-white">Paramètres du Compte</h1><p class="text-slate-400">Gérez votre profil, votre sécurité et vos préférences de notification.</p></header>
            
            <!-- Section pour les messages d'alerte -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <div class="card rounded-lg">
                <div class="border-b border-slate-700"><nav class="flex space-x-8 px-8" id="tabs-container">
                        <button data-tab="profile" class="tab-btn active font-semibold whitespace-nowrap py-4 border-b-2 border-transparent text-slate-400">Profil</button>
                        <button data-tab="security" class="tab-btn font-semibold whitespace-nowrap py-4 border-b-2 border-transparent text-slate-400">Sécurité</button>
                        <button data-tab="notifications" class="tab-btn font-semibold whitespace-nowrap py-4 border-b-2 border-transparent text-slate-400">Notifications</button>
                </nav></div>
                <div class="p-8">
                    <div id="profile-content" class="tab-content">
                        <h3 class="text-2xl text-white mb-6">Informations Personnelles</h3>
                        <div class="space-y-4 max-w-lg">
                             <div><label for="name" class="block text-sm font-medium text-slate-400 mb-2">Nom Complet</label><input type="text" id="name" value="{{ user.client_name }}" class="w-full bg-[#0a192f] border border-slate-700 rounded-md py-2 px-3 text-white"></div>
                             <div><label for="email" class="block text-sm font-medium text-slate-400 mb-2">Adresse e-mail</label><input type="email" id="email" value="{{ user.email }}" disabled class="w-full bg-slate-800 border border-slate-700 rounded-md py-2 px-3 text-slate-400 cursor-not-allowed"></div>
                             <div class="pt-4"><button class="bg-[#64ffda] text-[#0a192f] font-bold py-2 px-6 rounded hover:bg-opacity-90 transition-all">Enregistrer le Profil</button></div>
                        </div>
                    </div>
                    <div id="security-content" class="tab-content hidden">
                         <h3 class="text-2xl text-white mb-6">Changer le Mot de Passe</h3>
                         <!-- Formulaire pour changer le mot de passe -->
                         <form action="/change_password" method="POST" class="space-y-6 max-w-lg">
                            <div><label for="current_password" class="block text-sm font-medium text-slate-400 mb-2">Mot de passe actuel</label><input type="password" name="current_password" id="current_password" class="w-full bg-[#0a192f] border border-slate-700 rounded-md py-2 px-3 text-white" required></div>
                            <div><label for="new_password" class="block text-sm font-medium text-slate-400 mb-2">Nouveau mot de passe</label><input type="password" name="new_password" id="new_password" class="w-full bg-[#0a192f] border border-slate-700 rounded-md py-2 px-3 text-white" required></div>
                            <div><label for="confirm_password" class="block text-sm font-medium text-slate-400 mb-2">Confirmer le nouveau mot de passe</label><input type="password" name="confirm_password" id="confirm_password" class="w-full bg-[#0a192f] border border-slate-700 rounded-md py-2 px-3 text-white" required></div>
                            <div class="pt-4"><button type="submit" class="bg-[#64ffda] text-[#0a192f] font-bold py-2 px-6 rounded hover:bg-opacity-90 transition-all">Changer le Mot de Passe</button></div>
                         </form>
                    </div>
                    <div id="notifications-content" class="tab-content hidden">
                        <h3 class="text-2xl text-white mb-6">Notifications par E-mail</h3>
                        <div class="space-y-4 max-w-lg">
                            <label class="flex items-center space-x-3 p-4 bg-[#0a192f] rounded-lg border border-slate-700"><input type="checkbox" class="h-5 w-5 rounded bg-slate-700 border-slate-600 text-[#64ffda] focus:ring-[#64ffda]" checked><div><p class="font-medium text-white">Résumé Hebdomadaire des Performances</p><p class="text-sm text-slate-400">Recevez un résumé des performances de votre compte chaque lundi.</p></div></label>
                            <label class="flex items-center space-x-3 p-4 bg-[#0a192f] rounded-lg border border-slate-700"><input type="checkbox" class="h-5 w-5 rounded bg-slate-700 border-slate-600 text-[#64ffda] focus:ring-[#64ffda]"><div><p class="font-medium text-white">Alertes de Drawdown Important</p><p class="text-sm text-slate-400">Recevez une notification immédiate si votre compte subit une baisse significative.</p></div></label>
                            <div class="pt-4"><button class="bg-[#64ffda] text-[#0a192f] font-bold py-2 px-6 rounded hover:bg-opacity-90 transition-all">Enregistrer les Préférences</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const logoCanvas = document.getElementById('logo-canvas');
            if (logoCanvas) {
                const ctx = logoCanvas.getContext('2d'); const w = logoCanvas.width; const h = logoCanvas.height; const color = '#64ffda';
                const points = [ {x: w*0.5, y: h*0.1}, {x: w*0.85, y: h*0.3}, {x: w*0.9, y: h*0.6}, {x: w*0.6, y: h*0.9}, {x: w*0.2, y: h*0.8}, {x: w*0.1, y: h*0.45}, {x: w*0.65, y: h*0.65}, {x: w*0.85, y: h*0.85} ];
                ctx.strokeStyle = color; ctx.lineWidth = 1.2; ctx.beginPath();
                ctx.moveTo(points[0].x, points[0].y); ctx.lineTo(points[1].x, points[1].y); ctx.lineTo(points[2].x, points[2].y); ctx.lineTo(points[3].x, points[3].y); ctx.lineTo(points[4].x, points[4].y); ctx.lineTo(points[5].x, points[5].y); ctx.closePath();
                ctx.moveTo(points[1].x, points[1].y); ctx.lineTo(points[4].x, points[4].y); ctx.moveTo(points[0].x, points[0].y); ctx.lineTo(points[3].x, points[3].y); ctx.moveTo(points[6].x, points[6].y); ctx.lineTo(points[7].x, points[7].y); ctx.stroke();
                ctx.fillStyle = color; points.forEach(p => { ctx.beginPath(); ctx.arc(p.x, p.y, 1.8, 0, Math.PI * 2); ctx.fill(); });
            }
            const tabsContainer = document.getElementById('tabs-container');
            const tabContents = document.querySelectorAll('.tab-content');
            const tabButtons = document.querySelectorAll('.tab-btn');
            if (tabsContainer) {
                tabsContainer.addEventListener('click', (e) => {
                    if(e.target.matches('.tab-btn')) {
                        tabButtons.forEach(btn => btn.classList.remove('active')); e.target.classList.add('active');
                        const tabId = e.target.dataset.tab;
                        tabContents.forEach(content => { content.classList.toggle('hidden', content.id !== `${tabId}-content`); });
                    }
                });
            }
        });
    </script>
</body>
</html>

